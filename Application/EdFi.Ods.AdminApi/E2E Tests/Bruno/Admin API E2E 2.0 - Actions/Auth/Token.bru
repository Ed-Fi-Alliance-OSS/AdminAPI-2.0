meta {
  name: Token
  type: http
  seq: 2
}

post {
  url: {{API_URL}}/connect/token
  body: formUrlEncoded
  auth: none
}

script:pre-request {
  const client_id = bru.getEnvVar("ClientId");
  const client_secret = bru.getEnvVar("ClientSecret");
  const grant_type = "client_credentials";
  const scope = "edfi_admin_api/full_access";
  
  console.log(client_id);
  console.log(client_secret);
  
  req.setBody({
    client_id,
    client_secret,
    grant_type,
    scope
  });
}

script:post-response {
  
  bru.setVar("TOKEN",res.getBody().access_token);
}
